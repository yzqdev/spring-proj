package im.zhaojun.zfile.filterimport cn.hutool.core.util.ReflectUtilimport org.apache.catalina.connector.Responseimport org.springframework.core.annotation.Orderimport org.springframework.http.HttpStatusimport org.springframework.stereotype.Componentimport java.io.IOExceptionimport javax.servlet.*import javax.servlet.annotation.WebFilterimport javax.servlet.http.HttpServletResponse/** * 对于因前端 vue history 路由模式下, 直接访问路径时, 出现的 404 响应码, 转化为 200 响应码. (404 下会将请求转发到首页) */@Order(0)@WebFilter(value = ["/*"])@Componentclass NotFoundFilter : Filter {    @Throws(IOException::class, ServletException::class)    override fun doFilter(request: ServletRequest, response: ServletResponse, chain: FilterChain) {        // 执行请求        chain.doFilter(request, response)        // 拿到返回值, 如果是 404, 则转为 200        val httpServletResponse = response as HttpServletResponse        if (httpServletResponse.status == HttpStatus.NOT_FOUND.value()) {            val res = ReflectUtil.getFieldValue(response, "response") as Response            if (res != null) {                //  修改状态，默认情况 放过调用链执行后 response.setStatus 失败                res.isAppCommitted = false                res.isSuspended = false                httpServletResponse.status = 200            }        }    }}